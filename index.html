<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>CTV Live</title>
  <style>
    body { font-family: Arial, sans-serif; text-align: center; background: #111; color: #fff; }
    video { width: 90%; max-width: 600px; margin-top: 20px; border: 3px solid #0f0; border-radius: 12px; }
    h1 { color: #0f0; }
  </style>
</head>
<body>
  <h1>ðŸ“º CTV Live</h1>
  <p id="roleLabel"></p>
  <video id="video" autoplay playsinline controls></video>

  <script>
    // Role from URL
    const urlParams = new URLSearchParams(window.location.search);
    const role = urlParams.get("role") || "watcher"; // default watcher
    document.getElementById("roleLabel").innerText = "You are: " + role;

    // --- Simple WebRTC ---
    const pc = new RTCPeerConnection();
    const videoEl = document.getElementById("video");

    if (role === "broadcaster") {
      navigator.mediaDevices.getUserMedia({ video: true, audio: true })
        .then(stream => {
          videoEl.srcObject = stream;
          stream.getTracks().forEach(track => pc.addTrack(track, stream));
        });
    } else {
      pc.ontrack = event => {
        videoEl.srcObject = event.streams[0];
      };
    }

    // Dummy signaling for demo (replace with real server later)
    pc.onicecandidate = e => {
      if (e.candidate) console.log("New ICE:", e.candidate);
    };
  </script>
</body>
</html>
